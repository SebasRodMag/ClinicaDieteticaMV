<div class="modal fade show d-block" tabindex="-1" role="dialog" *ngIf="visible">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content p-3">
            <div class="modal-header">
                <h5 class="modal-title">
                    {{ esNuevo ? 'Crear nuevo historial' : 'Editar historial' }}
                </h5>
                <button type="button" class="btn-close" (click)="cerrar.emit()"></button>
            </div>

            <div class="modal-body">
                <form>
                    <!-- SelecciÃ³n de paciente -->
                    <div class="mb-3">
                        <label for="paciente">Paciente</label>
                        <ng-select [items]="pacientes" bindLabel="nombreCompleto" bindValue="id"
                            placeholder="Seleccione un paciente" [(ngModel)]="historial.id_paciente" name="id_paciente"
                            [searchable]="true" [clearable]="false" [disabled]="!esNuevo" required></ng-select>
                    </div>

                    <!-- Fecha -->
                    <div class="mb-3">
                        <label for="fecha">Fecha</label>
                        <input type="date" class="form-control" [(ngModel)]="historial.fecha" name="fecha"
                            [min]="fechaActual" required />
                    </div>

                    <!-- Observaciones -->
                    <div class="mb-3">
                        <label for="observaciones">Observaciones</label>
                        <textarea class="form-control" rows="3" [(ngModel)]="historial.observaciones_especialista"
                            name="observaciones_especialista"></textarea>
                    </div>

                    <!-- Recomendaciones -->
                    <div class="mb-3">
                        <label for="recomendaciones">Recomendaciones</label>
                        <textarea class="form-control" rows="2" [(ngModel)]="historial.recomendaciones"
                            name="recomendaciones"></textarea>
                    </div>

                    <!-- Dieta -->
                    <div class="mb-3">
                        <label for="dieta">Dieta</label>
                        <textarea class="form-control" rows="2" [(ngModel)]="historial.dieta" name="dieta"></textarea>
                    </div>

                    <!-- Lista de compra -->
                    <div class="mb-3">
                        <label for="listaCompra">Lista de Compra</label>
                        <textarea class="form-control" rows="2" [(ngModel)]="historial.lista_compra"
                            name="lista_compra"></textarea>
                    </div>
                </form>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" (click)="cerrar.emit()">Cancelar</button>
                <button class="btn btn-primary" [disabled]="!esFormularioValido()" (click)="guardar.emit(historial)">
                    Guardar
                </button>
            </div>
        </div>
    </div>
</div>